---
layout: post
title: "Тестирование адаптивных сайтов"
h1: "Тестирование адаптивных сайтов"
categories: protips
---

Как правильно [замечают](http://www.quirksmode.org/blog/archives/2010/02/the_iphone_obse.html) многие хорошие ребята, проверить работоспособность вашего адаптивного творения на айфончике недостаточно (ССЫЛКИ).
Как минимум, стоит озаботиться несколькими основными платформами: iOS, Android (а там свой зоопарк браузеров), Windows Phone,
Blackberry.

Если вы Лев Толстой не только на словах, то все перечисленное --- ваш обязательный
минимум, который вы радостно расширяете любыми попадающимися под руку железками и эмуляторами.

##Коротко про десктопные браузеры
###Windows

Первым делом --- последние стабильные версии Firefox, Chrome, Opera, Safari, IE плюс Opera 12, с этим все ясно. Через годик о 12 Опере и движке Presto можно будет забыть насовсем :-(

С IE все как всегда через задницу. Несколько версий держать нельзя, всякие ИЕ-тестеры --- лажа. Даже если заработают, родной икспишный рендеринг шрифтов с их помощью увидеть не получится.

Выход --- ставим VirtualBox, клонируем три виртуалки с winXP, отдаем
им по 192 Mb оперативки и ставим,
соответственно, 6, 7 и 8 осликов. IE6 я лично держу для всяких редких случаев. На его полноценную поддержку я давно забил. Делаем еще одну виртуалку на Win 7 (512 Mb оперативки) и ставим туда IE9. Все это хозяйство замечательно летает
параллельно.

<figure>
	<img src="i/virtual_machines.jpg">
	<figcaption>Уи-и-и-и</figcaption>
</figure>

В IE10 по умолчанию включено автообновление, поэтому, надеюсь, когда выйдет 11, под десятый не придется делать еще одну виртуалку.

По желанию можно поставить какой-нибудь Firefox 3.6. Часто помогает отловить простые баги, связанные с использованием новых фич в CSS. Обычно легко фиксится фоллбеком на старые свойства. Этакая проверка на Graceful Degradation.

###Linux & Mac

Стоит также иметь виртуалку с каким-нибудь дистрибутивом Линукса, и, если есть возможность, ухватить железку с OS X. Отличия рендеринга в одних и тех же браузерах в разных системух незначительны и в основном появляются там, где рендеринг зависит от системных элементов. Например, отличаются системные курсоры и элементы форм. Также значительно отличается рендеринг шрифтов.

##Мобильные устройства

Первое правило: есть возможность тестировать на железке, а не на эмуляторе, --- тестируйте на железке. Вот пара причин:

- Эмулятор не потрогать. Размер текста, ссылок, кнопок, работу тача в целом можно адекватно оценить только на устройстве.
- Производительность эмулятора часто не соответствует производительности железки. Не получится увидеть тормоза и переполнение памяти на слабых устройствах при загрузке кучи хайрезных картинок, не оценить скорость отрисовки анимаций и работы скриптов.
- Много глючных и неудобных эмуляторов.
- Отсутствие эмуляторов редких устройств.

ПЕРЕРАБОТАТЬ

Мой подход к покупке девайсов был такой: купить устройства на разных платформах с разным назначением, и хотя бы одно должно быть планшетом (другой вьюпорт). В результате были куплены планшет Galaxy Tab 2 с андроидом 4.1, мобилка HTC 8x на WP8 и iPod Touch 5.

Потом появились Nexus 4 (мобилка с андроидом), Kindle Keyboard со своим черно-белым вебкитом (одна из тех железок, под которые стоит адаптировать сайты просто из спортивного интереса) и Nokia Asha 501 (мобилка на модифицированной S40 с ужасным Ovi браузером и Оперой мини на JAVA). Еще из Китая едет нонеймовая мобилка с андроидом 2.3 и Nintendo DSi, который я заказал после прочтения [вот этой статьи](http://maban.co.uk/73).

<figure>
	<img src="i/zoo.jpg">
	<figcaption>Скромный зоопарк</figcaption>
</figure>

Покупайте девайсы, отбирайте старье у друзей, заказывайте редкие штуки на [dx.com](//dx.com) и на [ебее](//ebay.com). Разводите свой зоопарк.

###Где тестировать

Обязательный набор:

- **iOS** --- Safari и Opera Mini
- **Android** --- дефолтный браузер на 2.x, дефолтный браузер на 4.x, Chrome, Firefox, Opera Classic, Opera, Opera Mini
- Windows Phone 8
- Blackberry 10

Бонус-пак в порядке важности (субъективно):

- Java-приложение Opera Mini
- Windows Phone 7.8
- Прошлые версии iOS
- Прошлые версии Blackberry
- Ovi browser

For fun:

- Kindle Keyboard
- Sony PSP, PS Vita
- Nintendo DSi, 3DS
- Любые другие железки и эмуляторы, до которых дотянутся руки

###Где взять эмуляторы

{% include stuff/emulators.md %}

###Проблемные места в мобильных браузерах

Если вы фигачите респонсив-сайты, то наверняка знаете, что такое [Модернайзер](//modernizr.com) и как он работает. Тест на фичи это гут, но некоторые фичи либо не детектятся совсем, либо работают с багами, либо дают фолс позитивы в тестах. Для вторых и третьих я завел [табличку](https://docs.google.com/spreadsheet/ccc?key=0AjA1cIs8C8MGdFdyQ0lMQnhMbHJEeVZpMW9XejhzU2c&usp=sharing). Табличка периодически пополняется.

Основной принцип: есть фолс-позитив, который ну никак не обойти --- фигач браузер-сниффинг. С фичами, которые не детектятся принципиально, или состоят из фолс-позитивов чуть менее, чем полностью, отдельная история:

####Position: fixed
ПОТЕСТИТЬ Про position: fixed уже написана куча статей (например, [статья](http://www.quirksmode.org/blog/archives/2010/12/the_fifth_posit.html), где подробно рассказывается, почему эта проблема вообще существует). Проблема усложняется тем, что протестировать адекватность поддержки этого свойства невозможно. Мой подход --- не использовать совсем, или, если очень хочется,  

####Блоки со скроллом

Адекватность работы `overflow: scroll` и `overflow: auto` не детектится, совсем. Блоки не скроллятся в андроиде ниже 4 и айОси ниже 5 (вроде). Еще их не поскроллить в Опере Мини, Ovi и, наверное, в других редких случаях
###iOS

На айОси все браузеры кроме Оперы Мини пользуются местным рендером Сафари, меняется только интерфейс.

##Про роутер