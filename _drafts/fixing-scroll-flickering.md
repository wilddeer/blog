---
layout: post
title: "Чиним дерганый скролл"
categories: internet-maintenance
lang: ru
---

#Чиним "дерганый" скролл в Хроме

Пока я делал [Stickyfill](/scripts/stickyfill/), я успел наглядеться на множетсво различных "залипашек", и все они страдали одной фигней: мигали при переходе из одного состояния в другое.

Вот как-то так:

<div class="peppermint js-peppermint">
  {% include pic.htm src='flickering-1.gif' a='Пример дерганого скролла №1' %}
  {% include pic.htm src='flickering-2.gif' a='Пример дерганого скролла №2' %}
  {% include pic.htm src='flickering-3.gif' a='Пример дерганого скролла №3' %}
  {% include pic.htm src='flickering-4.gif' a='Пример дерганого скролла №4' %}
</div>

"Ну уж я-то сделаю как надо", - подумал я. Но фиг там. Мой стикифил дергался как все.

Сама природа такого поведения заключается в том, что браузер сначала проскролливает страницу, а только потом триггерит событие `scroll`. Сделано это, видимо, чтобы повысить отзывчивость управления. В результате код выполняется с запозданием, и мы видим "дерготню".

Я убил день на то, чтобы придумать, как с этим бороться.

Происходит это в хроме и в ИЕ. В Фаерфоксе и старой Опере скролл плавный и замедленная прорисовка если и есть, то ее не заметно.

В Хроме скролл моментальный, проматывает картинку одним махом из начального положения в конечное. В ИЕ скролл плавный, но событие триггерится только одно, и то с небольшой задержкой. Промежуточных событий нет, поэтому блок, привязанный к скроллу, по окончании движения сразу прыгает в новое положение.
