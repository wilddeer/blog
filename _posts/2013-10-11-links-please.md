---
layout: post
title: "Links, please"
categories: p
lang: ru
---

#Links, please

Однажды наступит тот день, когда [самые](//twitter.com) [продвинутые](//instagram.com) [IT-компании](//plus.google.com) научатся пользоваться ссылками. Тогда заживем.

##Три правила ссылок

###Раз

Если вам в `href` очень хочется положить `javascript: void(0);`, `#` или еще какую-нибудь фигню, успокойтесь, глубоко вздохните и замените ссылку на `button`.

Кнопка воспринимает событие `click`, стили `:hover` и `:active` и попадает в общий _taborder_ точно так же, как и ссылка. Невероятно!

<figure class="info"><div markdown="1">
Можно также использовать любой другой тег, например `span`, но он не попадет в *taborder*, а событие *click* не будет вызываться по нажатию энтера и пробела, что убивает все преимущества кнопки в плане _accessibility_.

Можно добавить спану аттрибут `taborder="0"` и повесить обработчики на нажатие пробела и энтера, а можно не париться и сделать `button`, который еще и семантически более уместен.
</div></figure>

###Два

Если вам очень хочется запихнуть в ваш элемент `onclick="location.href='...'"`, остановитесь, вздохните еще раз и сделайте ссылку. Теперь вашу ссылку можно открыть в новой вкладке, вызвать контекстное меню браузера с кучей функций, а адрес ссылки будет виден при наведении мыши. Поразительно!

###Три

Единственный случай, когда можно (и нужно) вешать обработчик на ссылку --- если есть что показать по ссылке. При этом важно, чтобы обработчик срабатывал только при нажатии левой кнопки мыши без кнопок-модификаторов.

Классический пример --- превьюшки фоток. При нажатии на превьюшку показывается большая фотка поверх текущего контента. При клике колесом или *ctrl*-клике фотка открывается в новой вкладке. Контекстное меню тоже работает. Юзеры с отключенным&nbsp;/ сломанным яваскриптом получают рабочую ссылку на фотку. Все довольны:

HTML:

{% highlight html cssclass=codewrap %}
{% include snippets/proper-link.htm %}
{% endhighlight %}

JS + jQuery:

{% highlight js cssclass=codewrap %}
{% include snippets/proper-link.js %}
{% endhighlight %}

Результат:

<figure>
	{% include snippets/proper-link.htm %}
</figure>

<script>
dzDelayed.push(function() {
	{% include snippets/proper-link.js %}
});
</script>

ИЕ версии 8 и ниже в событие `click` всегда возвращает `button` равный нулю. В результате клик колесом также приведет к выполнению функции, но все остальное будет работать корректно. Я бы с этим не заморачивался, но если очень хочется, [можно заморочиться](http://unixpapa.com/js/mouse.html).

##Хорошие ребята

Есть много других ситуаций, в которых также очень желательно оставлять функционал ссылки. Смотрите, как делают хорошие ребята:

###Переключение страниц

[Пагинатор комментариев на vk.com](http://vk.com/wall-35502680_11833) переключает страницы без перезагрузки, но оставляет возможность открыть страницу в новой вкладке.

###Форма логина&nbsp;/ регистрации

На [реддите](//reddit.com) форма логина и регистрации открывается в попапе поверх текущей странице, если кликнуть левой кнопкой мыши, и на новой вкладке, если нажать колесом. Правда, они не учли кнопок-модификаторов.

###Дополненный функционал

Случайно наткнулся на этот пример, когда на [метакритике](http://www.metacritic.com/game/pc/limbo) отказались загружаться скрипты. Кнопка *Expand* под пользовательскими отзывами --- ссылка на ту же страницу с GET-параметром, например `?user_review_id=1713311`. При отключенном или сломанном (как в моем случае) яваскрипте сервер отдаст вам страницу с раскрытым отзывом пользователя. Отличный фоллбек, сохранивший функционал сайта при упавшем CDN-сервере.

##Плохие ребята

###Twitter

Твиттер встал на путь истины и стал потихоньку исправлять свои косяки. Профиль юзера можно открыть в новой вкладке --- гут. Кнопочка *refresh* в сайдбаре и кнопка нового твита используют `button` --- тоже гут (а можно было и ссылку на форму нового твита сделать).

Тем не менее, постоянно попадаются `< a href="#">`. Ссылки *reply*, *retweet* и *favourite* никуда не ведут, [а](https://twitter.com/intent/tweet?in_reply_to=386573856179113985) [могли](https://twitter.com/intent/retweet?tweet_id=386573856179113985) [бы](https://twitter.com/intent/favorite?tweet_id=386573856179113985).

###Google+

Та же ситуация, что и с Твиттером. В целом, ребята исправляются (раньше все было очень плохо), тем не менее на главной странице менюшка переключения кругов по-прежнему использует `data-dest="stream/circles/p4765f1c30e7d2c98"` вместо нормальной ссылки, а аватарка в верхнем правом углу завернута в ссылку с моим любимым `javascript:void(0)`.

###Instagram

Все плохо. `javascript:;` в кнопках, ни одна ссылка не открывается в новой вкладке. Ребята запилили навигацию через хистори стейты, но о вкладках не особо слышали.

##TL;DR

Используйте `button` для действий на странице, `a` для ссылок и для действий с фоллбеком, доступным по ссылке.

Несмотря на то, что сейчас сложно найти устройство без яваскрипта, ситуации, когда скрипт по той или иной причине не загружается или выполняется с ошибкой, происходят довольно часто. В таких случаях грамотные фоллбеки помогут сохранить функционал сайта.

##Ссылки по теме

- <a class="iconlink" href="http://pepelsbey.net/pres/push-it/">«<span>Жми сюда!</span>»</a>, *Вадим Макеев*
- [Javascript Madness: Mouse Events](http://unixpapa.com/js/mouse.html), *Jan Wolter*